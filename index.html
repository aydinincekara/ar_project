<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>3D EÄŸitim PortalÄ±</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        // --- GELÄ°ÅTÄ°RÄ°LMÄ°Å SÃœRÃœKLEME VE TIKLAMA MOTORU ---
        AFRAME.registerComponent('akilli-kontrol', {
            schema: { speed: { default: 2.5 }, friction: { default: 0.92 } },
            init: function () {
                this.ifMouseDown = false;
                this.x_cord = 0;
                this.y_cord = 0;
                this.velocityX = 0;
                this.velocityY = 0;
                
                // TÄ±klama vs SÃ¼rÃ¼kleme ayrÄ±mÄ± iÃ§in deÄŸiÅŸkenler
                this.startX = 0;
                this.startY = 0;
                this.isDragging = false; 

                // Event Listener'larÄ± baÄŸla
                this.onStart = this.onStart.bind(this);
                this.onEnd = this.onEnd.bind(this);
                this.onMove = this.onMove.bind(this);

                // Hem MasaÃ¼stÃ¼ hem Mobil iÃ§in dinleyiciler
                document.addEventListener('mousedown', this.onStart);
                document.addEventListener('touchstart', (e) => this.onStart(e.touches[0]));
                
                document.addEventListener('mouseup', this.onEnd);
                document.addEventListener('touchend', this.onEnd);
                
                document.addEventListener('mousemove', this.onMove);
                document.addEventListener('touchmove', (e) => this.onMove(e.touches[0]));
            },

            onStart: function (e) {
                // EÄŸer menÃ¼ butonlarÄ±na basÄ±ldÄ±ysa 3D'yi elleme
                if(e.target && e.target.closest && (e.target.closest('.modal') || e.target.closest('.menu-btn'))) return;

                this.ifMouseDown = true;
                this.x_cord = e.clientX;
                this.y_cord = e.clientY;
                
                // TÄ±klama kontrolÃ¼ iÃ§in baÅŸlangÄ±Ã§ noktasÄ±nÄ± kaydet
                this.startX = e.clientX;
                this.startY = e.clientY;
                this.isDragging = false; // HenÃ¼z sÃ¼rÃ¼klemedik varsayÄ±yoruz

                // Tutunca dÃ¶nmeyi durdur
                this.velocityX = 0;
                this.velocityY = 0;
            },

            onMove: function (e) {
                if (this.ifMouseDown) {
                    var currentX = e.clientX;
                    var currentY = e.clientY;

                    // Hareket miktarÄ±nÄ± hesapla
                    var diffX = currentX - this.startX;
                    var diffY = currentY - this.startY;

                    // EÄŸer 5 pikselden fazla hareket varsa, bu artÄ±k bir SÃœRÃœKLEMEDÄ°R
                    if (Math.abs(diffX) > 5 || Math.abs(diffY) > 5) {
                        this.isDragging = true;
                    }

                    var temp_x = currentX - this.x_cord;
                    var temp_y = currentY - this.y_cord;

                    this.velocityY = temp_x * this.data.speed / 200; // YavaÅŸlatÄ±lmÄ±ÅŸ hassasiyet
                    this.velocityX = temp_y * this.data.speed / 200;

                    this.x_cord = currentX;
                    this.y_cord = currentY;
                }
            },

            onEnd: function () {
                // EÄŸer fare bÄ±rakÄ±ldÄ±ysa ve hiÃ§ sÃ¼rÃ¼kleme olmadÄ±ysa (isDragging = false)
                // Bu bir TIKLAMADIR!
                if (this.ifMouseDown && !this.isDragging) {
                    // Modal'Ä± aÃ§ma kodunu tetikle
                    modalAc('modal-hack'); // VarsayÄ±lan olarak Hackoutlon veya bilgi menÃ¼sÃ¼
                }
                this.ifMouseDown = false;
            },

            tick: function () {
                if (!this.ifMouseDown) {
                    // SÃ¼rtÃ¼nme etkisi
                    this.velocityX *= this.data.friction;
                    this.velocityY *= this.data.friction;
                    
                    // Nesneyi dÃ¶ndÃ¼r
                    this.el.object3D.rotation.y += this.velocityY;
                    this.el.object3D.rotation.x += this.velocityX;
                }
            },
            
            remove: function() {
                // Temizlik (Sayfa deÄŸiÅŸirse eventler ÅŸiÅŸmesin)
                document.removeEventListener('mousedown', this.onStart);
                document.removeEventListener('touchstart', this.onStart);
                document.removeEventListener('mouseup', this.onEnd);
                document.removeEventListener('touchend', this.onEnd);
                document.removeEventListener('mousemove', this.onMove);
                document.removeEventListener('touchmove', this.onMove);
            }
        });
    </script>

    <style>
        body { margin: 0; overflow: hidden; font-family: 'Segoe UI', sans-serif; }
        
        #ui-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10;
            display: flex; flex-direction: column; justify-content: space-between;
            padding: 20px; box-sizing: border-box;
            background: linear-gradient(to bottom, rgba(0,0,0,0.8), rgba(0,0,0,0), rgba(0,0,0,0.9));
            pointer-events: none; /* DokunuÅŸlarÄ± arkaya geÃ§irir */
        }

        .header { text-align: center; color: white; margin-top: 20px; pointer-events: none; }
        .header h1 { margin: 0; font-size: 1.5rem; color: #ff9f43; text-transform: uppercase; }
        .header p { margin: 5px 0; font-size: 0.8rem; color: #aaa; }

        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 30px; pointer-events: none; }
        
        .menu-btn {
            background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2); border-radius: 15px;
            padding: 20px; text-align: center; color: white;
            display: flex; flex-direction: column; align-items: center; gap: 10px;
            pointer-events: auto; /* Butonlar tÄ±klanabilir */
            transition: 0.2s;
        }
        .menu-btn:active { transform: scale(0.95); background: rgba(255, 159, 67, 0.2); }
        .menu-btn i { font-size: 1.5rem; color: #ff9f43; }

        .modal {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.9);
            width: 85%; max-width: 400px; background: rgba(20, 20, 25, 0.95);
            border: 1px solid #ff9f43; border-radius: 15px; padding: 25px; color: white;
            display: none; opacity: 0; pointer-events: auto; z-index: 20; transition: 0.3s;
        }
        .modal.aktif { display: block; opacity: 1; transform: translate(-50%, -50%) scale(1); }
        .modal h2 { margin-top: 0; color: #ff9f43; border-bottom: 1px solid #444; padding-bottom: 10px; }
        .modal ul { padding-left: 20px; color: #ccc; }
        .kapat-btn { background: #ff4757; color: white; border: none; width: 100%; padding: 10px; border-radius: 8px; margin-top: 15px; font-weight: bold; cursor: pointer; }
    </style>
</head>

<body>

    <div id="ui-layer">
        <div class="header">
            <h1>EÄŸitmen PortalÄ±</h1>
            <p>Modeli Ä°ncelemek Ä°Ã§in SÃ¼rÃ¼kleyin</p>
        </div>

        <div class="menu-grid">
            <div class="menu-btn" onclick="modalAc('modal-maker')"><i class="fa-solid fa-cube"></i><span>Maker</span></div>
            <div class="menu-btn" onclick="modalAc('modal-robot')"><i class="fa-solid fa-microchip"></i><span>Robotik</span></div>
            <div class="menu-btn" onclick="modalAc('modal-code')"><i class="fa-solid fa-code"></i><span>YazÄ±lÄ±m</span></div>
            <div class="menu-btn" onclick="modalAc('modal-hack')"><i class="fa-solid fa-trophy"></i><span>Hackoutlon</span></div>
        </div>
    </div>

    <div id="modal-maker" class="modal"><h2>ğŸ§Š Maker & 3D</h2><ul><li>Tinkercad</li><li>3D BaskÄ±</li><li>Fusion 360</li></ul><button class="kapat-btn" onclick="modalKapat()">Kapat</button></div>
    <div id="modal-robot" class="modal"><h2>ğŸ¤– Robotik</h2><ul><li>Arduino</li><li>VEX IQ</li><li>SensÃ¶rler</li></ul><button class="kapat-btn" onclick="modalKapat()">Kapat</button></div>
    <div id="modal-code" class="modal"><h2>ğŸ’» YazÄ±lÄ±m</h2><ul><li>Python</li><li>Unity</li><li>Mobil App</li></ul><button class="kapat-btn" onclick="modalKapat()">Kapat</button></div>
    <div id="modal-hack" class="modal"><h2>ğŸ† Hackoutlon</h2><p><b>EÄŸitim Ä°Ã§eriÄŸi:</b><br>TakÄ±mlar belirlenen sÃ¼rede proje geliÅŸtirir.</p><button class="kapat-btn" onclick="modalKapat()">Kapat</button></div>

    <a-scene background="color: black">
        
        <a-light type="ambient" color="#ffffff" intensity="0.4"></a-light>
        <a-light type="directional" position="2 4 3" intensity="1"></a-light>
        <a-light type="point" position="-2 2 2" intensity="0.8" color="#ff9f43" distance="10"></a-light>

        <a-assets>
            <a-asset-item id="kupu" src="egitim_kupu.glb"></a-asset-item>
        </a-assets>

        <a-entity 
            id="rotator-wrapper" 
            position="0 1.2 -4" 
            akilli-kontrol="speed: 2; friction: 0.95">

            <a-entity 
                gltf-model="#kupu" 
                scale="0.5 0.5 0.5"
                position="0 0 0"> 
            </a-entity>
            
        </a-entity>

        <a-camera position="0 1.6 0"></a-camera>

    </a-scene>

    <script>
        function modalKapat() { document.querySelectorAll('.modal').forEach(m => m.classList.remove('aktif')); }
        function modalAc(id) { modalKapat(); document.getElementById(id).classList.add('aktif'); }
    </script>

</body>
</html>
